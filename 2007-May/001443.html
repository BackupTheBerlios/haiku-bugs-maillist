<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-bugs] [Haiku] #975: the filesystem API should support sparse files for the call &quot;get_file_map&quot;
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-bugs/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-bugs%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-bugs%5D%20%5BHaiku%5D%20%23975%3A%20the%20filesystem%20API%20should%20support%0A%20sparse%20files%20for%20the%20call%20%22get_file_map%22&In-Reply-To=%3C049.f667cbb5bd940df5a6e6d9869fc80a5e%40haiku-os.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001441.html">
   <LINK REL="Next"  HREF="001460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-bugs] [Haiku] #975: the filesystem API should support sparse files for the call &quot;get_file_map&quot;</H1>
    <B>Haiku</B> 
    <A HREF="mailto:haiku-bugs%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-bugs%5D%20%5BHaiku%5D%20%23975%3A%20the%20filesystem%20API%20should%20support%0A%20sparse%20files%20for%20the%20call%20%22get_file_map%22&In-Reply-To=%3C049.f667cbb5bd940df5a6e6d9869fc80a5e%40haiku-os.org%3E"
       TITLE="[Haiku-bugs] [Haiku] #975: the filesystem API should support sparse files for the call &quot;get_file_map&quot;">trac at haiku-os.org
       </A><BR>
    <I>Mon May 21 15:37:34 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001441.html">[Haiku-bugs] [Haiku] #284: BMenu needs diagonal mouse movement	support (easy)
</A></li>
        <LI>Next message: <A HREF="001460.html">[Haiku-bugs] [Haiku] #1003: KDL while expanding a file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1443">[ date ]</a>
              <a href="thread.html#1443">[ thread ]</a>
              <a href="subject.html#1443">[ subject ]</a>
              <a href="author.html#1443">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>#975: the filesystem API should support sparse files for the call &quot;get_file_map&quot;
----------------------------+-----------------------------------------------
  Reporter:  korli          |       Owner:  axeld         
      Type:  enhancement    |      Status:  new           
  Priority:  normal         |   Milestone:  R1            
 Component:  System/Kernel  |     Version:  R1 development
Resolution:                 |    Platform:  All           
----------------------------+-----------------------------------------------
Comment (by bonefish):

 Adding at least read support for sparse files to the file cache (which
 would suffice for UDF) should require relatively few changes. It wouldn't
 even be necessary to add another field to file_io_vec; one could simply
 use a negative offset as indicator.

 In fact the only two changes necessary should be to
  * replace negative offsets by LONG_LONG_MIN in
 file_cache.cpp:get_file_map() and
  * use a small wrapper for vfs_read_pages() which simply clears the pages
 in case of a negative offset.

-- 
Ticket URL: &lt;<A HREF="http://dev.haiku-os.org/ticket/975#comment:5">http://dev.haiku-os.org/ticket/975#comment:5</A>&gt;
Haiku &lt;<A HREF="http://dev.haiku-os.org">http://dev.haiku-os.org</A>&gt;
The Haiku operating system.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001441.html">[Haiku-bugs] [Haiku] #284: BMenu needs diagonal mouse movement	support (easy)
</A></li>
	<LI>Next message: <A HREF="001460.html">[Haiku-bugs] [Haiku] #1003: KDL while expanding a file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1443">[ date ]</a>
              <a href="thread.html#1443">[ thread ]</a>
              <a href="subject.html#1443">[ subject ]</a>
              <a href="author.html#1443">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-bugs">More information about the Haiku-bugs
mailing list</a><br>
</body></html>
